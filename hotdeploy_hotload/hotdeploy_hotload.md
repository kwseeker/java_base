## 热部署与热加载

### 两者区别

热部署，就是在应用正在运行的时候升级部分模块软件，却不需要重新启动整个应用
（如Tomcat上运行着servlet应用，我们使用类加载器在Tomcat没关闭的情况下将servlet更新，并释放之前旧的servlet的过程）。

热加载和热部署相似，但是热加载不会释放旧的类。 

热部署主要用于生产环境，热加载主要用于开发环境。

使用热加载的缺点是这种直接修改jvm中字节码的方式是难以监控的，安全风险很大。

需要热部署的场景也比较少，两种主要使用场景：
1. 频繁的部署并且启动耗时长的应用
2. 无法停止服务的应用

### 实现原理
热部署与热加载的前提状态：类的实现已经修改，名字还是原来的。

类加载器不能重新加载一个已经加载了的类（使用同一个加载器加载的每一个类的Class实例都只有一个），
但只要使用一个新的类加载器实例，就可以将类再次加载到一个正在运行的应用程序。

实现热部署和热加载功能分为以下几部分：  
1. 区分不变的部分与变化的部分；两者分层开发，预先定义好接口。从此以后接口不会变，只有接口实现会变。
2. 告诉不变的部分应该监听变化部分的哪些地方，实现监听器。
3. 监听到变化之后，获取变化的类，实现新的类加载器，加载更新后的类。
4. 热部署还要释放旧的类的内存。

配置文件变化重新加载：

### 目标实现监听 .jar, .class, .yml


### 遗留的没想清楚的问题
1. 如何查看应用中加载了哪些类，哪些实例？
2. 热部署之后释放内存，是释放的哪些内存，实例和类都释放掉了么？
